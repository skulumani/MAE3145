\documentclass[10pt]{article}
\usepackage{amssymb,amsmath,times,url,graphicx,amsthm,alltt}
%\usepackage[pdftex,urlcolor=blue,pdfpagemode=none,pdfstartview=FitH]{hyperref}
\usepackage{my_packages}
\usepackage{tikz_packages}
%% url smaller font.
\makeatletter
\def\url@leostyle{%
  \@ifundefined{selectfont}{\def\UrlFont{\sf}}{\def\UrlFont{\small\ttfamily}}}
\makeatother
\urlstyle{leo}

%\usepackage[all,import]{xy}

\renewcommand{\baselinestretch}{1.2}
\date{}

\renewcommand{\thesubsection}{\arabic{subsection}. }
\renewcommand{\thesubsubsection}{\arabic{subsection}.\arabic{subsubsection} }

\theoremstyle{definition}
\newtheorem{prob}{Problem}[section]
%\renewcommand{\theprob}{\arabic{section}.\arabic{prob}}
\renewcommand{\theprob}{\arabic{prob}}

\newenvironment{subprob}%
{\renewcommand{\theenumi}{\alph{enumi}}\renewcommand{\labelenumi}{(\theenumi)}\begin{enumerate}}%
{\end{enumerate}}%

\newenvironment{matlab}
{\begin{alltt}\small\renewcommand{\baselinestretch}{1.2}\selectfont}%
{\end{alltt}}


\begin{document}



\setcounter{page}{1}
\pagestyle{plain}
\section*{MAE3145: Homework 3}
\vspace*{-0.4cm}
\noindent{Due date: \SI{2458031.1979166665}{\julianday} }%\\%\vspace*{0.5cm}

%\begin{prob}
%Consider a spacecraft moving in a potential field specified as $U(\norm{\vec r})$. The equation of motion is given by
%\begin{align}
%\ddot{\vec r} = -\deriv{U}{\vec r}.
%\end{align}
%\begin{subprob}
%\item Show that the specific angular momentum $\vec h = \vec r \times \dot {\vec r}$ is still preserved.
%\item Show that the energy $\mathcal{E}=\frac{1}{2}\dot{\vec r}\cdot \dot{\vec r} + U(\norm{\vec r})$ is preserved.
%\end{subprob}
%\end{prob}

\begin{prob}
The relative motion of the two-body problem is described by
\begin{align}
\ddot{\vec r} = -\frac{\mu}{r^3}\vec r.
\end{align}
The specific angular momentum $\vec h$ and the eccentricity $\vec e$ are defined as follows:
\begin{align*}
\vec h = \vec r \times \vec v,\quad \vec e = \frac{\vec v\times\vec h}{\mu}- \frac{\vec r}{r}.
\end{align*}
In class, we found that $\vec h$ is fixed, i.e. $\dot{\vec h}=0$. Here, we wish to show $\vec e$ is fixed according to the following steps:
\begin{subprob}
\item Using (1), show that $\dfrac{d}{dt}(\vec v\times\vec h) = -\dfrac{\mu}{r^3} \vec r\times \vec h$.
\item Using the definition of $\vec h$, show that $\dfrac{1}{r^3}\vec r \times \vec h = \dfrac{\vec r \dot r - \dot{\vec r} r}{r^2}$.\\
(Hint: $\vec a\times (\vec b \times \vec c) = (\vec a \cdot \vec c)\vec b - (\vec a \cdot \vec b)\vec c$,\; $\vec r \cdot \vec r = r^2$, and $\vec r \cdot \dot{\vec r} = r\dot r$).
\item Show that $\dfrac{d}{dt}\dfrac{\vec r}{r} = -\dfrac{\vec r \dot r - \dot{\vec r} r}{r^2}$.
\item By combining the results of parts (a), (b), and (c), show that $\dfrac{d}{dt}\vec e=0$, i.e, the eccentricity vector is fixed.
\end{subprob}
\end{prob}

\begin{prob}
A satellite is on an elliptic orbit around the Earth with a perigee radius of $r_p=7000\,\mathrm{km}$ and an apogee radius of $r_a=70000\,\mathrm{km}$. Assume that the gravitational parameter and the radius of the Earth are $\mu=398600\,\mathrm{km^3/s^2}$, and $R_E=6378\,\mathrm{km}$, respectively. Determine the following parameters (specify units in $\mathrm{km},\,\mathrm{sec},\,\mathrm{degree}$). 
\begin{subprob}
\item eccentricity $e$
\item period $T$ 
\item specific energy $\mathcal{E}$
\item true anomaly $\theta$ at which the altitude is $1000\,\mathrm{km}$.
\item velocity $v_r,v_\theta$ at the point found in part (d).
\end{subprob}
\end{prob}

%\begin{prob}
%Consider an elliptic orbit with the distance to the periapsis $r_p$ and the distance to the apoapsis $r_a$. Using the properties summarized at the third page, show that the velocity at the periapsis and the velocity at the apoapsis are given by
%\begin{align*}
%v_p = \sqrt{\frac{2\mu}{r_a+r_p}\frac{r_a}{r_p}}
%,\quad
%v_a = \sqrt{\frac{2\mu}{r_a+r_p}\frac{r_p}{r_a}}.
%\end{align*}
%
%\end{prob}

\clearpage\newpage
\begin{prob}
The specific energy and angular momentum of several asteroids heading toward the Earth have been measured as follows:

\begin{center}
\begin{tabular}{c|c|c}\hline
Asteroid & $\mathcal{E}$ $(\mathrm{km^2/s^2})$ & $h$ $(\mathrm{km^2/s})$\\ \hline
1 & $1$ & $1\times 10^5$\\
2 & $100$ & $1\times 10^5$\\
3 & $0$ & $7\times 10^4$\\
4 & $0$ & $8\times 10^4$\\
5 & $10$ & $8\times 10^4$\\\hline
\end{tabular}
\end{center}
%
We wish to determine whether any asteroid is likely to hit the Earth. The trajectory of an asteroid is assumed to be the solution of the two-body problem of the asteroid and the Earth, where \( \mu_\oplus \) is taken from the course constants sheet.

\begin{subprob}
\item Using the fact that $\mathcal{E}$ and $h$ are conserved, show that the distance at the periapsis $r_p$ satisfies the following quadratic equation:
\begin{gather}
2\mathcal{E}\, r_p^2 + 2\mu_E\, r_p -h^2=0. 
\end{gather}
(Hint: at the periapsis, $h=rv$ since $\vec r$ is perpendicular to $\vec v$.)
\item Calculate $r_p$ for all asteroids, and determine which asteroid will hit the surface of the Earth: an asteroid will hit the Earth if $r_p < R_\oplus = \SI{6378.137}{\kilo\meter}$.\\
    (Hint: In Python/\texttt{numpy}, the quadratic equation $ax^2+bx+c=0$ can be solved by the command \texttt{np.roots([a, b, c])}.)
\item For each asteroid that hits the surface of the Earth, calculate its impact velocity at the surface of the Earth.\\
(Note: the impact velocity is not same as the velocity at the periapsis.)
\item For each asteroid that does not hit the surface of the Earth, calculate its velocity when it is closest to the Earth.
\end{subprob}
\end{prob}

\begin{prob}
    Consider the point of intersection of an elliptical orbit with the \underline{semi-minor} axis.
    \begin{subprob}
    \item Prove that the following relationships are true:
        \begin{align*}
            r &= a \\
            v &= \sqrt{\frac{\mu}{r}} \\
            \theta &= \arccos \parenth{-e} 
        \end{align*}
        Hint: The first thing to try is to draw a picture. 
        Next utilize the equation of a conic section to investigate the relationships.
    \item Given the conic equation
        \begin{align*}
            r = \frac{p}{1 + e \cos \theta}
        \end{align*}
        find the derivative \(  \dot{r} \).
    \item Prove that \( \dot{r} \) possesses a maximum magnitude at the ends of the semi-latus rectum. 
    \item Show that this maximum magnitude corresponds to \( \pm e \sqrt{\frac{\mu}{p}} \).
    \end{subprob}
\end{prob}

\clearpage\newpage
\begin{prob}
    At approximately \SI{2458011.99706}{\julianday}, Cassini orbiter completed its mission studying the Saturnian system and re-entered Saturn to avoid contamination of any possible exterrestrial life in the Saturn system.
    Over the course of its nearly \SI{20}{\year} mission, Cassini studied the planet Saturn, its ring system, and numerous natural satellites. 
    In order to reach Saturn, Cassini used several gravity assist manuevers of Venus, Earth and Jupiter, in order to increase its orbital velocity with respect to the Sun and gain enough energy to intercept Saturn. 
    The Cassini mission remains the largest interplanetary vehicle launched by the United States, consisting of the Cassini Orbiter and Huygens lander.
    The Huygens lander parachuted to a soft landing on Titan on \SI{2458011.99706}{\julianday} and remains the most distant interplanetary landing of any human-made vehicle.
    \begin{figure}[htbp]
        \centering
        \subcaptionbox{Cassini Interplanetary Trajectory\label{fig:cassini_interplanetary}}{\includegraphics[width=0.5\textwidth]{figures/cassini_trajectory.jpg}}~
        \subcaptionbox{Cassini Trajectory 2004 to 2005\label{fig:cassini_traj}}{\includegraphics[width=0.5\textwidth]{figures/Figure_1.pdf}}\\
       \subcaptionbox{Cassini Orbiter\label{fig:cassini_orbiter}}{\includegraphics[width=0.8\textwidth]{figures/7754_CassiniPlungeInstrumentsLabeled.jpg}}
       \caption{Cassini Mission} 
    \end{figure}

    Here we will investigate the orbit of Cassini 13 years ago on Sep 15, 2004.
    On this date, the position and velocity of Cassini with respect to Saturn barycenter are given as 
    \begin{align*}
    \bar{r} &= \begin{bmatrix} -7546026.6144396 & -3717105.21901527 & -1515557.34280287\end{bmatrix} \si{\kilo\meter} \\
    \bar{v} &= \begin{bmatrix}  0.89506649 & -0.33312074  & 0.21519571 \end{bmatrix} \si{\kilo\meter\per\second}
    \end{align*}

    \begin{subprob}
        \item Given this position and velocity vector, determine the type of orbit of Cassini.
        \item Determine the period \( P \), angular momentum vector \( \bar h \), semi-latus rectum \( p \), specific mechanical energy \( \mathcal{E}\), eccentricity \( e \), true anomoly \( \nu \), and radius of periapsis and apoapsis \( r_p, r_a\).
        \item How does the velocity of Cassini compare to the velocity of a circular orbit at this radius, i.e. compare \( v \) and \( \sqrt{2} v_c \)?
            Should the velocity of Cassini be less than or greater than \( \sqrt{2} v_c \)? Why or why not?
        \item Using Python, create a diagram of the orbital plane and the location of Cassini.
            Mark the location of periapsis and the local horizontal/local vertical unit reference frame, \( \hat r, \hat \theta \) as well as the perifocal reference frame \( \hat p, \hat q \).
        \item The major subdivisions of the Saturn ring system are copied below from \href{https://en.wikipedia.org/wiki/Rings_of_Saturn#Major_subdivisions}{Wikipedia}.
            \begin{figure}[htbp]
                \centering
                \includegraphics[width=0.5\textwidth]{figures/ring_subdivisions.png}
                \caption{Ring Subdivisions}
            \end{figure}
            Based on the current orbital properties, which ring subdivision does Cassini pass through.
    \end{subprob}
\end{prob}

\begin{prob}
    In a chance meeting in the Science and Engineering hall, you've bumped into Elon Musk.
    He is the CEO of Tesla Motors and SpaceX and is planning on sending manned missions to Mars.
    Unfortunately, Mr.~Musk has never taken an astrodynamics class and is in need of your help to plan his latest mission.
    \begin{subprob}
    \item The Dragon capsule is in a circular parking orbit of the Earth, at an altitude of \SI{120}{\kilo\meter}.
    To begin a voyage to Mars, what velocity does the satellite require to \underline{escape the Earth}.
    \item Would your answer be different for an elliptical orbit ( \( e = 0.3\), \( \nu = \SI{145}{\degree} \), with \( a \) the same as the previous problem)?
        Why or why not?
    \item If you assume both burns are tangent to the existing velocity, what are the required increases in velocity for each of the previous cases?
    \end{subprob}
\end{prob}

\begin{prob}
    The data below are composed of postion, \( \bar r \) in \si{\kilo\meter}, and velocity, \( \bar v \) in \si{\kilo\meter\per\second} vectors in the Earth Centered Inertial frame. 
    Each row corresponds to the state of a particular satellite in Earth orbit. 
    The first three columns define the position vector \( \bar r = r_i \hat i + r_j \hat j + r_k \hat k \; \si{\kilo\meter} \) and the last three columns define the velocity vector \( \bar v = v_i \hat i + v_j \hat j + v_k \hat k \; \si{\kilo\meter\per\second} \).
Units should be provided in degrees, seconds, and kilometers.

There is also a text version of this data for your use to avoid copying data into your program manually. 
    \begin{verbatim}
 -2568.039216     -6547.314638     -3797.326891     6.458278    -2.209367    -0.076621
 -1436.423824     -5431.538653     -4007.257672    -0.015594     4.517853    -6.106364
  2984.202691      -176.720794      6508.528498    -4.795316     5.200641     2.349382
  -219.841243     -6955.769665      1566.508699     2.057499    -1.655460    -6.993727
 -6340.603015     -3677.405631       769.660350     1.884915    -1.940508     6.893215
   983.782888      1404.894524     -6970.421237     0.707420    -7.294167    -1.366025
 -4226.545784      3746.042884     -3754.276534    -1.669581    -6.154428    -4.256676
-36907.139939    -20390.700208        31.019634     1.485986    -2.691551     0.000191
 -4040.322336     -3817.380008      4609.308074     2.323401     4.297389     5.603866
-42105.752864     -2109.705740        -1.757288     0.153815    -3.071269     0.000729
   324.774908     -5123.791037     -4299.929506     7.462166    -0.943707     1.710663
  2027.998510     -2854.859077      6288.292372    -5.467349     3.694938     3.441169
    \end{verbatim}
    For the given orbital data below, determine the following for each satellite.

    \begin{subprob}
    \item Orbital properties
    \begin{itemize}
        \item Period -- \( P \) 
        \item Specifc mechanical energy -- \( \mathcal{E} \) 
        \item Eccentricity vector and magnitude -- \( \bar e\)
        \item True anomaly -- \( \nu \)
        \item Radius of periapsis and apoapsis -- \( r_p, r_a \)
        \item Angular momentum vector and magnitude -- \( \bar h \)
        \item Flight path angle -- \( \gamma \)
    \end{itemize}

    The orbital properties of the last satellite, bottom row, is given below.
    You should provide your hand calculations demonstrating the computation of the orbital properties for this case. 
    This test case is used to verify your software is working correctly.
    For the other cases, you can simply provide the output of your program.
\item Plot the orbital plane and mark the location of the satellite.
    Mark the location and periapsis and apoapsis, the local horizontal/local vertical frame, and flight path angle.
    \end{subprob}

Solution for last satellite:

    \begin{verbatim}
0 METOP-B 38771  

Satellite State  
Position and Velocity in LVLH frame                                  
r_hat:         7197.61205237841 km rd_hat:    0.000384971542236516 km/sec
t_hat:                        0 km td_hat:        7.44218488029298 km/sec
h_hat:                        0 km hd_hat:                       0 km/sec

Position and Velocity in EPH/PQW frame                               
e_hat:         6597.28000494701 km ed_hat:       -2.97519497807265 km/sec
p_hat:          2877.7622891527 km pd_hat:        6.82160763919443 km/sec
h_hat:                        0 km hd_hat:                       0 km/sec

Position and Velocity in IJK frame                                   
i_hat:         2027.99850966934 km id_hat:       -5.46734944705212 km/sec
j_hat:        -2854.85907707635 km jd_hat:        3.69493774585229 km/sec
k_hat:         6288.29237165041 km kd_hat:        3.44116855425005 km/sec

RAD_MAG   :     7197.61205237841 km = 4.81130650615441e-05 AU        
VEL_MAG   :     7.44218489024994 km/sec                              

Orbital Elements                  
sma:           7198.46581949393 km raan:          321.364089112604 deg
ecc:       0.000129393718755839    arg_p:         38.5452264914522 deg
inc:                    98.7138 deg nu:           23.5670395276775 deg

Elliptic Orbital Parameters       
P         :     7198.46569897193 km = 4.81187713365968e-05 AU        
ANG MOM   :     53565.9595904252 km^2/sec                            
PERIOD    :     6078.14237801228 sec =     1.68837288278119 hr       
ENGERGY   :    -27.6864897323373 km^2/sec^2                          
RAD_PER   :     7197.53438323221 km = 4.81125458753671e-05 AU        
RAD_APO   :     7199.39725575565 km =  4.8124998409106e-05 AU        

VEL_CIRC  :     7.44174359291353 km/sec                              
VEL_ESC   :     10.5242147168014 km/sec                              
TRUE_ANOM :     23.5670395276775 deg                                 
FPA       :  0.00296381303849746 deg                                 
ECC_ANOM  :     23.5640755388789 deg                                 
MEAN_ANOM :     23.5611117258625 deg                                 
MEAN_MOT  :   0.0592286224327851 deg/sec                             

T_PAST_PER:     397.799421261242 sec =    0.110499839239234 hr
    \end{verbatim}
\end{prob}
\end{document}


